<Window x:Class="Screen_Recorder.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Screen Recorder" Height="640" Width="900" WindowStartupLocation="CenterScreen"
        Background="{DynamicResource App.Background}">
    <Window.Resources>
        <LinearGradientBrush x:Key="HeaderGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#4F46E5" Offset="0"/>
            <GradientStop Color="#06B6D4" Offset="1"/>
        </LinearGradientBrush>
        <SolidColorBrush x:Key="App.Background" Color="#0B1016"/>
        <SolidColorBrush x:Key="Card.Background" Color="#111827"/>
        <SolidColorBrush x:Key="Card.Border" Color="#1F2937"/>
        <SolidColorBrush x:Key="Accent" Color="#06B6D4"/>
        <SolidColorBrush x:Key="Text.Primary" Color="#E5E7EB"/>
        <SolidColorBrush x:Key="Text.Secondary" Color="#9CA3AF"/>

        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="{DynamicResource Text.Primary}"/>
        </Style>
        <Style TargetType="Button">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="Margin" Value="6,0,0,0"/>
            <Setter Property="Background" Value="{DynamicResource HeaderGradient}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource HeaderGradient}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
        <Style TargetType="ComboBox">
            <Setter Property="Foreground" Value="{DynamicResource Text.Primary}"/>
            <Setter Property="Background" Value="#0F172A"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Card.Border}"/>
            <Setter Property="Margin" Value="6,0,0,0"/>
            <Setter Property="Width" Value="220"/>
        </Style>
        <Style TargetType="TextBox">
            <Setter Property="Foreground" Value="{DynamicResource Text.Primary}"/>
            <Setter Property="Background" Value="#0F172A"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Card.Border}"/>
            <Setter Property="Margin" Value="6,0,0,0"/>
        </Style>
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="{DynamicResource Text.Primary}"/>
            <Setter Property="Margin" Value="6,0,0,0"/>
        </Style>
        <Style x:Key="Card" TargetType="Border">
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Background" Value="{DynamicResource Card.Background}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Card.Border}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000000" BlurRadius="8" ShadowDepth="1" Opacity="0.4"/>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border CornerRadius="10" Background="{DynamicResource HeaderGradient}" Padding="16" Margin="0,0,0,12">
            <DockPanel>
                <TextBlock Text="Screen Recorder" FontSize="22" FontWeight="Bold" Foreground="White"/>
                <TextBlock DockPanel.Dock="Right" Text="{Binding Status}" Foreground="White" VerticalAlignment="Center"/>
            </DockPanel>
        </Border>

        <!-- Capture Card -->
        <Border Grid.Row="1" Style="{StaticResource Card}">
            <StackPanel>
                <TextBlock Text="Capture" FontWeight="Bold" Foreground="{DynamicResource Accent}" Margin="0,0,0,8"/>
                <WrapPanel>
                    <TextBlock Text="Source:" VerticalAlignment="Center"/>
                    <ComboBox SelectedItem="{Binding Settings.CaptureSource}" ItemsSource="{Binding CaptureSources}"/>
                    <TextBlock Text="Monitor:" VerticalAlignment="Center" Margin="12,0,0,0"/>
                    <ComboBox Width="260" SelectedItem="{Binding SelectedMonitor}" ItemsSource="{Binding Monitors}" DisplayMemberPath="DisplayName"/>
                    <CheckBox Content="Include Cursor" IsChecked="{Binding Settings.IncludeCursor}" Margin="12,0,0,0"/>
                </WrapPanel>
                <WrapPanel Margin="0,8,0,0">
                    <TextBlock Text="Region:" VerticalAlignment="Center"/>
                    <TextBox Width="60" Text="{Binding Settings.RegionX}" ToolTip="X"/>
                    <TextBox Width="60" Text="{Binding Settings.RegionY}" ToolTip="Y"/>
                    <TextBox Width="80" Text="{Binding Settings.RegionWidth}" ToolTip="W"/>
                    <TextBox Width="80" Text="{Binding Settings.RegionHeight}" ToolTip="H"/>
                    <TextBlock Text="FPS:" VerticalAlignment="Center" Margin="12,0,0,0"/>
                    <TextBox Width="60" Text="{Binding Settings.FPS}"/>
                </WrapPanel>
                <WrapPanel Margin="0,8,0,0">
                    <TextBlock Text="Encoder:" VerticalAlignment="Center"/>
                    <ComboBox Width="360"
                              ItemsSource="{Binding Encoders}"
                              SelectedItem="{Binding Settings.VideoEncoder}"/>
                    <TextBlock Text="Quality:" VerticalAlignment="Center" Margin="12,0,0,0"/>
                    <ComboBox Width="160"
                              ItemsSource="{Binding QualityLevels}"
                              SelectedItem="{Binding Settings.QualityLevel}"/>
                </WrapPanel>
            </StackPanel>
        </Border>

        <!-- Audio + Output + Controls -->
        <Border Grid.Row="2" Style="{StaticResource Card}">
            <DockPanel>
                <StackPanel DockPanel.Dock="Top">
                    <TextBlock Text="Audio" FontWeight="Bold" Foreground="{DynamicResource Accent}"/>
                    <WrapPanel Margin="0,8,0,8">
                        <CheckBox Content="Record System Audio (WASAPI default)" IsChecked="{Binding Settings.RecordSystemAudio}"/>
                        <CheckBox Content="Mix System + Mic" IsChecked="{Binding Settings.MixMicAndSystem}" Margin="12,0,0,0"/>
                    </WrapPanel>

                    <TextBlock Text="Output" FontWeight="Bold" Foreground="{DynamicResource Accent}" Margin="0,8,0,0"/>
                    <WrapPanel Margin="0,8,0,0">
                        <TextBlock Text="Folder:" VerticalAlignment="Center"/>
                        <TextBox Width="480" Text="{Binding Settings.OutputFolder}"/>
                        <Button Content="Browse…" Command="{Binding BrowseOutputCommand}"/>
                        <TextBlock Text="File Name:" VerticalAlignment="Center" Margin="12,0,0,0"/>
                        <TextBox Width="220" Text="{Binding Settings.OutputFileNamePattern}" ToolTip="Recording_{yyyyMMdd_HHmmss}.mp4"/>
                    </WrapPanel>

                    <WrapPanel Margin="0,12,0,0">
                        <Button Content="Start" Width="140" Command="{Binding StartCommand}" IsEnabled="{Binding CanStart}"/>
                        <Button Content="Stop" Width="140" Command="{Binding StopCommand}" IsEnabled="{Binding IsRecording}"/>
                    </WrapPanel>
                </StackPanel>

                <TextBox Margin="0,12,0,0" Height="220" IsReadOnly="True" VerticalScrollBarVisibility="Auto" Text="{Binding Log}" Background="#0B1220" Foreground="{DynamicResource Text.Secondary}"/>
            </DockPanel>
        </Border>
    </Grid>
</Window>